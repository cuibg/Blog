## 字符编码学习笔记

#### 前言

当今计算机只能处理0和1表示的二进制数据（你硬盘里存储的所有数据、你浏览的网页、看的电影、小说等也都是由二进制数据存储或表示的），但人类通常处理的都是自然语言表示的数据，为了能让计算机和人类能相互理解对方的世界，就需要字符编码来做中间转换：即制定一个标准，将人类处理的每一个字符（比如汉字、英文字符、特殊符号等）都用唯一的二进制表示。

现存的字符编码规范有几百种之多，常见的几种如下：

#### 一、ASCLL

全称是`American Standard Code for Information Interchange`（美国信息交换标准代码）；

单字节编码，用一个字节（8个位）来表示一个字符，并保证最高位的取值永远为’0’；

最多表示2^7 =128个字符，这128个字符包括95个可打印的字符（涵盖了26个英文字母的大小写以及英文标点符号能）与33个控制字符（不可打印字符）；

#### 二、中文编码

名称  |         GB2312            |         BIG5           |           GBK           | GB18030
------------ | ------------------ | ------------- | ------------ | ------------
作用  | 国家简体中文字符集           | 统一繁体字符集           |GB2312的扩展，加入对繁体的支持| 中日韩文字编码
字节数| 1字节-兼容ASCII 2字节-汉字   |      2字节             |          2字节            | 1字节-兼容ASCII 2字节，4字节
范围  | 7445个符号，包括6763个汉字   |         21886个符号     |         21886个符号       | 27484个符号
兼容性| 00-7F范围内是1位，和ASCII兼容 | 兼容ASCII，但与GB2312冲突|         兼容GB2312       | 兼容GB2312

#### 三、Unicode

采用4个字节表示一个字符,这样理论上Unicode能表示的字符数就达到了2^31 = 2147483648 = 21 亿左右个字符，完全可以涵盖世界上一切语言所用的符号。

存在两个问题：

* Unicode对所有的字符编码均需要四个字节，而这对于拉丁字母或汉字来说是浪费的，其前面三个或两个字节均是0,这对信息存储来说是极大的浪费。

* 另外一个问题就是，如何区分Unicode与其它编码，比如计算机怎么知道四个字节表示一个Unicode中的字符，还是分别表示四个ASCII的字符呢？

以上两个问题，让Unicode的推广上一直面临着困难。

#### 四、UTF-8

UTF-8是Unicode的一种实现方式，而Unicode是一个统一标准规范，Unicode的实现方式除了UTF-8还有其它的，比如UTF-16等。

UTF-8在Unicode的基础上又两个基本规则：

* 对于单字节字符，字节的第一位为0，后7位为这个符号的Unicode码，所以对于拉丁字母，
UTF-8与ASCII码是一致的。

* 对于n字节(n>1)的字符，第一个字节前n位都设为1，第n+1位为0，后面字节的前两位一律设为10，
剩下没有提及的位，全部为这个符号的Unicode编码。

比如：

Unicode（十六进制） | UTF-8（二进制）
------------ | ------------- 
单字节：0000 0000-0000 007F | 0xxxxxxx
双字节：0000 0080-0000 07FF | 110xxxxx 10xxxxxx
三字节：0000 0800-0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx
四字节：0001 0000-0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx

举例来说，’微’的Unicode是’\u5FAE’，二进制表示是”00000000 00000000 01011111 10101110“，其取值就位于’0000 0800-0000 FFFF’之间，所以其UTF-8编码为’11100101 10111110 10101110’ 


需要注意的一点是Unicode(UTF-8)与GBK，GB2312这些汉字编码规则是完全不兼容的，也就是说这两者之间不能通过任何算法来进行转换,如需转换，一般通过GBK查表的方式来进行。

#### 五、如何区分Unicode和UTF-8编码

* 字节顺序以FFFE或FEFF开头

表示为Unicode编码，其中FFFE或FEFF叫做`Zero Width No-Break Space`，中文译名作“零宽无间断间隔”的字符

Unicode：编码是四个字节"FF FE 25 4E"，其中"FF FE"表明是小头方式存储，真正的编码是4E25。

Unicode big endian：编码是四个字节"FE FF 4E 25"，其中"FE FF"表明是大头方式存储。

* 字节顺序以EFBBBF开头

UTF-8：编码是六个字节"EF BB BF E4 B8 A5"，前三个字节"EF BB BF"表示这是UTF-8编码，后三个"E4B8A5"就是"严"的具体编码，它的存储顺序与编码顺序是一致的。


#### 参考文档

* [字符编码常识及问题解析](http://sharecore.net/blog/2014/08/10/zi-fu-bian-ma-chang-shi-ji-wen-ti-jie-xi/#rd?sukey=601c156da1897ae0f2fb74410ce75d7f6cd8e7046dfaf139b527689b1fdf5e1d4ccd7c1d10c93db525ddb6359874aec3)

* [《字符编码笔记：ASCII，Unicode和UTF-8》阮一峰](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)
